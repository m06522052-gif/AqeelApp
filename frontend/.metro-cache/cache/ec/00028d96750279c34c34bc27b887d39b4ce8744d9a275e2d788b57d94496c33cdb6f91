{"dependencies":[{"name":"expo-sqlite","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":38,"index":38}}],"key":"QiSBWdXsWfNLYLVy2O3EksR8vJg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"initDatabase\", {\n    enumerable: true,\n    get: function () {\n      return initDatabase;\n    }\n  });\n  Object.defineProperty(exports, \"getDatabase\", {\n    enumerable: true,\n    get: function () {\n      return getDatabase;\n    }\n  });\n  var _expoSqlite = require(_dependencyMap[0], \"expo-sqlite\");\n  var SQLite = _interopNamespace(_expoSqlite);\n  const initDatabase = async () => {\n    const db = await SQLite.openDatabaseAsync('abdulsalam.db');\n\n    // جدول المستخدمين\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS users (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      username TEXT NOT NULL UNIQUE,\n      email TEXT NOT NULL UNIQUE,\n      phone TEXT,\n      password TEXT NOT NULL,\n      role TEXT DEFAULT 'user',\n      is_active INTEGER DEFAULT 1,\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP\n    );\n  `);\n\n    // جدول المخازن\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS warehouses (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      name TEXT NOT NULL,\n      location TEXT,\n      type TEXT NOT NULL,\n      responsible TEXT,\n      status INTEGER DEFAULT 1,\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP\n    );\n  `);\n\n    // جدول الدفعات\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS batches (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      batch_number TEXT NOT NULL UNIQUE,\n      supplier TEXT NOT NULL,\n      receive_date TEXT NOT NULL,\n      bag_type TEXT NOT NULL,\n      quantity INTEGER NOT NULL,\n      price REAL NOT NULL,\n      responsible TEXT,\n      warehouse_id INTEGER,\n      notes TEXT,\n      status TEXT DEFAULT 'active',\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (warehouse_id) REFERENCES warehouses (id)\n    );\n  `);\n\n    // جدول المواد الخام - جديد\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS materials (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      material_number TEXT NOT NULL UNIQUE,\n      name TEXT NOT NULL,\n      description TEXT,\n      unit TEXT NOT NULL,\n      quantity REAL NOT NULL,\n      unit_price REAL NOT NULL,\n      supplier TEXT,\n      warehouse_id INTEGER,\n      minimum_stock REAL,\n      notes TEXT,\n      status TEXT DEFAULT 'active',\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (warehouse_id) REFERENCES warehouses (id)\n    );\n  `);\n\n    // جدول العمال\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS workers (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      name TEXT NOT NULL,\n      phone TEXT,\n      address TEXT,\n      registration_date TEXT NOT NULL,\n      status TEXT DEFAULT 'active',\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP\n    );\n  `);\n\n    // جدول التوزيع\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS distributions (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      distribution_number TEXT NOT NULL UNIQUE,\n      worker_id INTEGER NOT NULL,\n      batch_id INTEGER NOT NULL,\n      quantity INTEGER NOT NULL,\n      distribution_date TEXT NOT NULL,\n      expected_completion_date TEXT,\n      status TEXT DEFAULT 'pending',\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (worker_id) REFERENCES workers (id),\n      FOREIGN KEY (batch_id) REFERENCES batches (id)\n    );\n  `);\n\n    // جدول الإنتاج\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS production (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      distribution_id INTEGER NOT NULL,\n      quantity INTEGER NOT NULL,\n      production_date TEXT NOT NULL,\n      quality TEXT NOT NULL,\n      warehouse_id INTEGER,\n      notes TEXT,\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (distribution_id) REFERENCES distributions (id),\n      FOREIGN KEY (warehouse_id) REFERENCES warehouses (id)\n    );\n  `);\n\n    // جدول المدفوعات\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS payments (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      worker_id INTEGER NOT NULL,\n      distribution_id INTEGER,\n      amount REAL NOT NULL,\n      payment_date TEXT NOT NULL,\n      payment_method TEXT NOT NULL,\n      notes TEXT,\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (worker_id) REFERENCES workers (id),\n      FOREIGN KEY (distribution_id) REFERENCES distributions (id)\n    );\n  `);\n\n    // جدول حركات المخزون\n    await db.execAsync(`\n    CREATE TABLE IF NOT EXISTS inventory_movements (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      movement_type TEXT NOT NULL,\n      from_warehouse_id INTEGER,\n      to_warehouse_id INTEGER,\n      batch_id INTEGER,\n      quantity INTEGER NOT NULL,\n      responsible TEXT,\n      notes TEXT,\n      movement_date TEXT NOT NULL,\n      created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n      FOREIGN KEY (from_warehouse_id) REFERENCES warehouses (id),\n      FOREIGN KEY (to_warehouse_id) REFERENCES warehouses (id),\n      FOREIGN KEY (batch_id) REFERENCES batches (id)\n    );\n  `);\n\n    // إدراج مستخدم افتراضي للتجربة\n    try {\n      await db.runAsync('INSERT OR IGNORE INTO users (username, email, password, role) VALUES (?, ?, ?, ?)', 'admin', 'admin@abdulsalam.com', 'admin123', 'admin');\n    } catch (e) {\n      console.log('Default user already exists');\n    }\n    return db;\n  };\n  const getDatabase = async () => {\n    return await SQLite.openDatabaseAsync('abdulsalam.db');\n  };\n});","lineCount":197,"map":[[22,2,3,0,"Object"],[22,8,3,0],[22,9,3,0,"defineProperty"],[22,23,3,0],[22,24,3,0,"exports"],[22,31,3,0],[23,4,3,0,"enumerable"],[23,14,3,0],[24,4,3,0,"get"],[24,7,3,0],[24,18,3,0,"get"],[24,19,3,0],[25,6,3,0],[25,13,3,0,"initDatabase"],[25,25,3,0],[26,4,3,0],[27,2,3,0],[28,2,166,0,"Object"],[28,8,166,0],[28,9,166,0,"defineProperty"],[28,23,166,0],[28,24,166,0,"exports"],[28,31,166,0],[29,4,166,0,"enumerable"],[29,14,166,0],[30,4,166,0,"get"],[30,7,166,0],[30,18,166,0,"get"],[30,19,166,0],[31,6,166,0],[31,13,166,0,"getDatabase"],[31,24,166,0],[32,4,166,0],[33,2,166,0],[34,2,1,0],[34,6,1,0,"_expoSqlite"],[34,17,1,0],[34,20,1,0,"require"],[34,27,1,0],[34,28,1,0,"_dependencyMap"],[34,42,1,0],[35,2,1,0],[35,6,1,0,"SQLite"],[35,12,1,0],[35,15,1,0,"_interopNamespace"],[35,32,1,0],[35,33,1,0,"_expoSqlite"],[35,44,1,0],[36,2,3,7],[36,8,3,13,"initDatabase"],[36,20,3,25],[36,23,3,28],[36,29,3,28,"initDatabase"],[36,30,3,28],[36,35,3,40],[37,4,4,2],[37,10,4,8,"db"],[37,12,4,10],[37,15,4,13],[37,21,4,19,"SQLite"],[37,27,4,25],[37,28,4,26,"openDatabaseAsync"],[37,45,4,43],[37,46,4,44],[37,61,4,59],[37,62,4,60],[39,4,6,2],[40,4,7,2],[40,10,7,8,"db"],[40,12,7,10],[40,13,7,11,"execAsync"],[40,22,7,20],[40,23,7,21],[41,0,8,0],[42,0,9,0],[43,0,10,0],[44,0,11,0],[45,0,12,0],[46,0,13,0],[47,0,14,0],[48,0,15,0],[49,0,16,0],[50,0,17,0],[51,0,18,0],[51,3,18,3],[51,4,18,4],[53,4,20,2],[54,4,21,2],[54,10,21,8,"db"],[54,12,21,10],[54,13,21,11,"execAsync"],[54,22,21,20],[54,23,21,21],[55,0,22,0],[56,0,23,0],[57,0,24,0],[58,0,25,0],[59,0,26,0],[60,0,27,0],[61,0,28,0],[62,0,29,0],[63,0,30,0],[64,0,31,0],[64,3,31,3],[64,4,31,4],[66,4,33,2],[67,4,34,2],[67,10,34,8,"db"],[67,12,34,10],[67,13,34,11,"execAsync"],[67,22,34,20],[67,23,34,21],[68,0,35,0],[69,0,36,0],[70,0,37,0],[71,0,38,0],[72,0,39,0],[73,0,40,0],[74,0,41,0],[75,0,42,0],[76,0,43,0],[77,0,44,0],[78,0,45,0],[79,0,46,0],[80,0,47,0],[81,0,48,0],[82,0,49,0],[83,0,50,0],[83,3,50,3],[83,4,50,4],[85,4,52,2],[86,4,53,2],[86,10,53,8,"db"],[86,12,53,10],[86,13,53,11,"execAsync"],[86,22,53,20],[86,23,53,21],[87,0,54,0],[88,0,55,0],[89,0,56,0],[90,0,57,0],[91,0,58,0],[92,0,59,0],[93,0,60,0],[94,0,61,0],[95,0,62,0],[96,0,63,0],[97,0,64,0],[98,0,65,0],[99,0,66,0],[100,0,67,0],[101,0,68,0],[102,0,69,0],[103,0,70,0],[103,3,70,3],[103,4,70,4],[105,4,72,2],[106,4,73,2],[106,10,73,8,"db"],[106,12,73,10],[106,13,73,11,"execAsync"],[106,22,73,20],[106,23,73,21],[107,0,74,0],[108,0,75,0],[109,0,76,0],[110,0,77,0],[111,0,78,0],[112,0,79,0],[113,0,80,0],[114,0,81,0],[115,0,82,0],[116,0,83,0],[116,3,83,3],[116,4,83,4],[118,4,85,2],[119,4,86,2],[119,10,86,8,"db"],[119,12,86,10],[119,13,86,11,"execAsync"],[119,22,86,20],[119,23,86,21],[120,0,87,0],[121,0,88,0],[122,0,89,0],[123,0,90,0],[124,0,91,0],[125,0,92,0],[126,0,93,0],[127,0,94,0],[128,0,95,0],[129,0,96,0],[130,0,97,0],[131,0,98,0],[132,0,99,0],[133,0,100,0],[133,3,100,3],[133,4,100,4],[135,4,102,2],[136,4,103,2],[136,10,103,8,"db"],[136,12,103,10],[136,13,103,11,"execAsync"],[136,22,103,20],[136,23,103,21],[137,0,104,0],[138,0,105,0],[139,0,106,0],[140,0,107,0],[141,0,108,0],[142,0,109,0],[143,0,110,0],[144,0,111,0],[145,0,112,0],[146,0,113,0],[147,0,114,0],[148,0,115,0],[149,0,116,0],[149,3,116,3],[149,4,116,4],[151,4,118,2],[152,4,119,2],[152,10,119,8,"db"],[152,12,119,10],[152,13,119,11,"execAsync"],[152,22,119,20],[152,23,119,21],[153,0,120,0],[154,0,121,0],[155,0,122,0],[156,0,123,0],[157,0,124,0],[158,0,125,0],[159,0,126,0],[160,0,127,0],[161,0,128,0],[162,0,129,0],[163,0,130,0],[164,0,131,0],[165,0,132,0],[165,3,132,3],[165,4,132,4],[167,4,134,2],[168,4,135,2],[168,10,135,8,"db"],[168,12,135,10],[168,13,135,11,"execAsync"],[168,22,135,20],[168,23,135,21],[169,0,136,0],[170,0,137,0],[171,0,138,0],[172,0,139,0],[173,0,140,0],[174,0,141,0],[175,0,142,0],[176,0,143,0],[177,0,144,0],[178,0,145,0],[179,0,146,0],[180,0,147,0],[181,0,148,0],[182,0,149,0],[183,0,150,0],[184,0,151,0],[184,3,151,3],[184,4,151,4],[186,4,153,2],[187,4,154,2],[187,8,154,6],[188,6,155,4],[188,12,155,10,"db"],[188,14,155,12],[188,15,155,13,"runAsync"],[188,23,155,21],[188,24,156,6],[188,107,156,89],[188,109,157,6],[188,116,157,13],[188,118,157,15],[188,140,157,37],[188,142,157,39],[188,152,157,49],[188,154,157,51],[188,161,158,4],[188,162,158,5],[189,4,159,2],[189,5,159,3],[189,6,159,4],[189,13,159,11,"e"],[189,14,159,12],[189,16,159,14],[190,6,160,4,"console"],[190,13,160,11],[190,14,160,12,"log"],[190,17,160,15],[190,18,160,16],[190,47,160,45],[190,48,160,46],[191,4,161,2],[192,4,163,2],[192,11,163,9,"db"],[192,13,163,11],[193,2,164,0],[193,3,164,1],[194,2,166,7],[194,8,166,13,"getDatabase"],[194,19,166,24],[194,22,166,27],[194,28,166,27,"getDatabase"],[194,29,166,27],[194,34,166,39],[195,4,167,2],[195,11,167,9],[195,17,167,15,"SQLite"],[195,23,167,21],[195,24,167,22,"openDatabaseAsync"],[195,41,167,39],[195,42,167,40],[195,57,167,55],[195,58,167,56],[196,2,168,0],[196,3,168,1],[197,0,168,2],[197,3]],"functionMap":{"names":["<global>","initDatabase","getDatabase"],"mappings":"AAA;4BCE;CDiK;2BEE;CFE"},"hasCjsExports":false},"type":"js/module"}]}